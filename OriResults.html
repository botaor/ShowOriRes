<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>COC - Results POM 2016</title>
	<style>
        html { height: 100%; margin: 0px; padding: 0px; }
        body { height: 100%; margin: 0px 20px; padding: 0px; }
		#top { width:100%; height:30px }
		.frameHeader { width:50%; height:100%; float:left; text-align: center; font: 30px Arial; padding: 15px 0px }
		.info { width:50%; height: calc(100% - 60px); float:left }
        .noScrolling { overflow: hidden; width: 100%; display:block; height:100%; border: none }
	</style>
</head>
<body>
    <div id="top">
        <div class="frameHeader">
            Homens/Men 
        </div>
        <div class="frameHeader">
            Damas/Women + Promoção/Open 
        </div>
    </div>
    <div id="left" class="info"><iframe scrolling="no" class="noScrolling" id="leftFRM" src=""></iframe></div>
    <div id="right" class="info"><iframe scrolling="no" class="noScrolling" id="rightFRM" src=""></iframe></div>

    <script src="Scripts/jquery-2.1.4.min.js"></script>
    <script>
        var scrollBaseTime = 5 * 1000;
        var scrollLineTime = 500;
        var stopTime = 10 * 1000;
        
        function MyAnimate( obj, txt, links, index ) {
            if( index >= links.length )
            {
                // provoque refresh
                obj.attr('src', obj.attr('src') );
                return ;
            }
                
            rows = links.eq(index).next( 'table' ).next( 'table' ).next( 'table' ).find('tr');
            
            $('html, body', txt).eq(0).animate({
                scrollTop: links.eq(index).offset().top
            }, scrollBaseTime + rows.length * scrollLineTime, function() {
                setTimeout( MyAnimate, stopTime, obj, txt, links, index+1 );
            });
        }
                
        function prepareIFrame( obj ) {
            obj.on( 'load', function() {
                // Erase extra elements
                var txt = obj.contents(); 
                $('#navigation', txt).remove();
                $('#reporttop', txt).remove();
                
                // Change font size
                $('td', txt).css( 'font', '16pt/1.2 Arial')
                $('th', txt).css( 'font', '16pt/1.2 Arial')
                
                // scroll to all link objects
                setTimeout( MyAnimate, stopTime, obj, txt, $('a', txt), 1 );
            }) ;
        }
        
        function doRefresh( obj, url ) {
            obj.attr('src',url);
        }
        
        $(function () {
            prepareIFrame( $('#leftFRM') );
            prepareIFrame( $('#rightFRM') );

            doRefresh( $('#leftFRM'), 'res1.html' );
            doRefresh( $('#rightFRM'), 'res2.html' );
        });
    </script>
</body>
</html>
